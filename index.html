<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Innova Space Education</title>

  <!-- Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-P64ZZSCZ7Z"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'G-P64ZZSCZ7Z');
  </script>

  <!-- Librer√≠as -->
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>

  <!-- Estilos propios -->
  <link rel="stylesheet" href="style.css" />
</head>

<body class="bg-gradient-to-br from-black via-indigo-900 to-purple-900 text-white font-sans">
  <main id="landing" class="relative">

    <!-- Barra lateral: bot√≥n Spotify m√°s grande con etiqueta -->
    <div class="side-dock">
      <button id="btn-spotify" class="dock-btn" title="Spotify">
        <!-- √çcono -->
        <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
          <defs>
            <linearGradient id="g" x1="2" y1="2" x2="22" y2="22">
              <stop stop-color="#22c55e"/><stop offset="1" stop-color="#a855f7"/>
            </linearGradient>
          </defs>
          <path d="M12 2.25C6.615 2.25 2.25 6.615 2.25 12S6.615 21.75 12 21.75 21.75 17.385 21.75 12 17.385 2.25 12 2.25Z" fill="url(#g)"/>
          <path d="M7.7 15.55c3.1-1.87 7.02-.99 8.92 0" stroke="currentColor" stroke-width="1.6" stroke-linecap="round" opacity=".9"/>
          <path d="M7.3 13.08c3.7-2.1 7.9-1.1 10 .1" stroke="currentColor" stroke-width="1.6" stroke-linecap="round" opacity=".8"/>
          <path d="M7.05 10.5c4.35-2.4 9.7-1.3 12.2.2" stroke="currentColor" stroke-width="1.6" stroke-linecap="round" opacity=".7"/>
        </svg>
        <span class="dock-label">Spotify</span>
      </button>
    </div>

    <!-- Panel lateral Spotify -->
    <aside id="music-panel" class="side-panel">
      <div class="flex items-center justify-between mb-2">
        <h3 class="text-lg">M√∫sica para el aprendizaje</h3>
        <button id="close-panel" class="close-panel">Cerrar ‚úï</button>
      </div>

      <div id="playlist-list" class="playlist-list"></div>

      <iframe id="spotify-embed" class="panel-iframe"
        src="" frameborder="0" allow="autoplay; clipboard-write; encrypted-media; fullscreen; picture-in-picture" loading="lazy">
      </iframe>
    </aside>

    <!-- Cabecera -->
    <section id="hero" class="text-center">
      <h1 class="text-5xl md:text-6xl font-extrabold bg-gradient-to-r from-pink-400 via-purple-400 to-blue-400 text-transparent bg-clip-text">
        Innova Space Education
      </h1>
      <p class="text-lg text-gray-300 mt-3">Educaci√≥n del futuro. Conectando estudiantes con IA.</p>
    </section>

    <!-- Chat -->
    <section id="main-chat" class="px-4">
      <div class="chat-wrap max-w-3xl mx-auto relative mt-2 w-full">
        <div class="flex items-center justify-center mb-4 gap-2">
          <h2 class="text-3xl md:text-4xl font-bold text-center m-0">Asistente IA - MIRA</h2>

          <!-- Avatar separado -->
          <object
            id="avatar-mira"
            type="image/svg+xml"
            data="avatar_mira.svg"
            class="still"
            tabindex="-1"
            aria-hidden="true">
          </object>
        </div>

        <div id="chat-card" class="bg-gray-900 border border-purple-500 rounded-xl p-4 shadow-xl relative">
          <div id="chat-shell">
            <!-- Vac√≠o: el saludo se inyecta por JS como burbuja -->
            <div id="chat-box" class="bg-gray-800 p-3 rounded-md mb-4 text-sm space-y-2 text-white"></div>

            <div class="flex gap-2">
              <input
                aria-label="Escribe tu mensaje"
                type="text" id="user-input"
                placeholder="Escribe tu mensaje..."
                class="flex-1 p-2 rounded-md bg-gray-700 text-white border border-gray-600"
                autocomplete="off"
                onkeydown="if(event.key==='Enter'){sendMessage();return false;}">
              <button id="send-btn" onclick="sendMessage()" class="bg-purple-600 hover:bg-purple-700 px-4 py-2 rounded-md text-white font-bold" tabindex="0">
                Enviar
              </button>
            </div>
          </div>
        </div>
      </div>
    </section>

  </main>

  <!-- Helpers UI b√°sicos -->
  <script>
    function toggleMiraInfo() {
      const info = document.getElementById("mira-info");
      if (!info) return;
      info.style.display = (info.style.display === "none" || info.style.display === "") ? "block" : "none";
    }
    function toggleAreas() {
      const list = document.getElementById("areas-list");
      if (list) list.classList.toggle("hidden");
    }
  </script>

  <!-- Chat logic -->
  <script src="chat.js"></script>

  <!-- Markdown + LaTeX helper (sigue) -->
  <script>
    function addAssistantMessage(text) {
      const chatBox = document.getElementById('chat-box');
      const html = `<div class="msg assistant"><div class="bubble chat-markdown">${marked.parse(text)}</div></div>`;
      chatBox.insertAdjacentHTML('beforeend', html);
      chatBox.scrollTop = chatBox.scrollHeight;
      if (window.MathJax) setTimeout(() => MathJax.typesetPromise(), 60);
    }
  </script>

  <!-- Spotify panel -->
  <script>
    // Playlists
    <script>
  // Playlists (con tus t√≠tulos pedidos)
  const PLAYLISTS = [
    // las 4 que ya ten√≠as renombradas
    { id: '4Ldou77MwYfWBV288FirwL', title: 'Electro House mix',       description: 'Beats para concentrarte con energ√≠a' },
    { id: '37i9dQZF1DWYY963019MQr', title: 'jazz',                    description: 'Instrumentales suaves para estudiar' },
    { id: '5jQ2Fy8vyfC2mE9oew8c2Q', title: 'Pop mix',                 description: 'Ambientes pop para inspirarte' },
    { id: '2EoheVFjqIxgJMb8VnDRtZ', title: 'K-Pop Hits',              description: 'Cl√°sicos modernos del K-Pop' },

    // ‚ûï nuevas
    { id: '09yz2h86ElsO8dwbxyplwt', title: 'Classic music',           description: 'Obras cl√°sicas para estudiar' },
    { id: '37i9dQZF1EIZna6YqhjeY0', title: 'Calvin harris',           description: 'Hits y colaboraciones de Calvin Harris' },
    { id: '37i9dQZF1EQmg9rwHdCwFW', title: 'Mix reggaeton',           description: 'Reggaet√≥n para motivarte' },
    { id: '4hnGrJpcuQepHdewJyUd0w', title: 'Musica relajante naturaleza', description: 'Sonidos de la naturaleza y relax' }
  ];

  let currentPlaylist = PLAYLISTS[0]; // sigue empezando por Electro House mix
  // (el resto del script permanece igual)
</script>


    let currentPlaylist = PLAYLISTS[0];

    function toggleMusicPanel() {
      const panel = document.getElementById('music-panel');
      panel?.classList.toggle('open');
      // üí° mueve/centra el contenido cuando el panel est√° abierto
      document.body.classList.toggle('panel-open', panel.classList.contains('open'));
    }

    function selectPlaylist(id) {
      const p = PLAYLISTS.find(x => x.id === id);
      if (!p) return;
      currentPlaylist = p;
      document.getElementById('spotify-embed').src =
        `https://open.spotify.com/embed/playlist/${currentPlaylist.id}?utm_source=generator&theme=0`;
      document.querySelectorAll('.playlist-item').forEach(el => {
        el.classList.toggle('active', el.dataset.id === id);
      });
    }

    document.addEventListener('DOMContentLoaded', () => {
      const list = document.getElementById('playlist-list');
      if (list) {
        PLAYLISTS.forEach(p => {
          const btn = document.createElement('button');
          btn.className = 'playlist-item';
          btn.dataset.id = p.id;
          btn.innerHTML = `<div class="text-sm font-semibold">${p.title}</div>
                           <div class="text-xs opacity-80">${p.description}</div>`;
          btn.addEventListener('click', () => selectPlaylist(p.id));
          list.appendChild(btn);
        });
      }
      selectPlaylist(currentPlaylist.id);

      document.getElementById('btn-spotify')?.addEventListener('click', toggleMusicPanel);
      document.getElementById('close-panel')?.addEventListener('click', toggleMusicPanel);
    });
  </script>
</body>
</html>
